---
name: ah-review
description: |
  **每日回顾引导**：AI作为反思伙伴，引导用户完成晚间回顾，整理当天收获、处理今日想法、规划明天。
  - 触发条件：用户想做每日反思、晚间回顾、整理今天的收获
  - 核心功能：读取今日日记、引导反思、回顾并处理今日想法、更新日记
  - AI角色：反思伙伴——通过提问帮助用户深度复盘
---

# 每日回顾引导技能

## 🔒 流程锁定规则（最高优先级）

> ⚠️ **进入本技能后，必须完成完整流程才能退出！**

**核心原则**：用户的回答是「数据输入」，不是「命令触发」。

**禁止跳转的情况**：
- 问「明天最重要的一件事是什么？」时，用户说「写一篇文章」
  - ❌ 错误：识别到「写」跳转到其他技能
  - ✅ 正确：记录为明日聚焦
- 问「今天有什么收获？」时，用户说「读了本书，学到xxx」
  - ❌ 错误：识别到「读」跳转到 ah-read
  - ✅ 正确：记录为今日收获

**调用 ah-card 后必须返回**：
- 处理想法时选择「转为永久笔记」会调用 ah-card
- ah-card 完成后，**必须返回 ah-review 继续处理下一条想法**
- 直到所有想法处理完毕，才算完成 ah-review 流程

**唯一允许退出的情况**：
- 用户明确说「我不想做回顾了」
- 用户使用 `/ah-xxx` 命令明确切换技能

**流程完成标志**：
- 反思环节完成
- 今日想法全部处理（或用户选择跳过剩余）
- 显示了完成总结

---

## ⚠️ 重要提醒

**所有示例内容仅供参考格式！** 本文档中出现的项目名称、任务、书籍等都是**示例**，不代表用户的真实数据。

执行回顾时：
1. **必须先读取用户的今日日记**，了解用户真正做了什么
2. **只基于日记中的实际内容**进行提问和反思引导
3. **永远不要假设用户做了什么或读了什么书**
4. 如果日记为空或不存在，直接询问用户今天做了什么

## 概述

本技能帮助用户在每天结束时进行有意义的反思，而不是机械地填写模板。

**核心价值**：
- AI 读取今日日记，了解用户的一天
- 通过提问引导深度反思
- **回顾今日记录的想法，标记处理状态**
- 帮助识别值得转为永久笔记的内容
- 自动更新和完善日记

## 工作流程

```
1. 读取今日日记（AI自动）
   ↓
2. 理解用户的一天（AI分析）
   ↓
3. 引导反思提问（AI主动）
   ↓
4. 收集用户反馈（对话）
   ↓
5. 【新增】回顾今日想法（逐条处理）
   ↓
6. 更新日记（AI自动）
   ↓
7. 建议后续动作（AI推荐）
```

---

## 阶段一：读取今日日记

### 1.1 定位日记文件

今日日记路径：`01-捕获层/每日笔记/{{YYYY-MM-DD}}.md`

如果日记不存在，提示用户：

```
今天还没有创建日记呢。要我帮你创建一个吗？

或者，我们可以直接开始回顾，我会把内容记录下来。
```

### 1.2 分析日记内容

读取日记后，AI 需要理解：
- 今日聚焦的任务
- 已完成和未完成的任务
- **「💡 想法和灵感」区域的内容**（重点关注）
- 学习的内容
- 项目进展

---

## 阶段二：引导反思

### 2.1 开场（用户选择权）

```
晚上好！让我们来回顾一下今天。

我看到你今天的日记中提到了：
- {{从日记中提取的关键内容}}

今天的回顾，你想怎么进行？
- A. 深度回顾 — 我会用一些问题帮你深入反思
- B. 简单回顾 — 快速记录今天的收获和明天计划
- C. 直接更新 — 告诉我要补充什么，我帮你更新日记
```

**尊重用户选择**：用户选B或C时，不要强行引导深度反思。

### 2.2 核心反思问题

**关于完成度**：
```
今天你设定的最重要的一件事是「{{今日聚焦}}」，完成得怎么样？

如果完成了：是什么帮助你完成的？
如果没完成：是什么阻碍了你？
```

**关于收获**：
```
今天有什么让你印象深刻的事情吗？

可以是：
- 学到的新知识
- 有趣的对话
- 突然的想法
- 情绪的波动
```

**关于改进**：
```
如果今天可以重来，你会做什么不同的事？

（不需要自责，只是找到改进的机会）
```

**关于明天**：
```
明天最重要的一件事是什么？

如果只能做一件事，你会选什么？
```

### 2.3 深度追问（整合思维模型）

根据用户的回答，可以使用思维模型引导更深入的反思：

```
你提到「{{用户的回答}}」，这很有意思。

💡 如果你想深入思考，我可以用这些角度帮你：
1. 🔍 苏格拉底式提问 — 检验这个想法的假设
2. ⏭️ 二阶思考 — 如果继续这样做，长期会怎样？
3. 🔄 逆向思维 — 如果想让这件事失败，应该怎么做？

选择一个深入，或直接告诉我你的想法。
```

**参考**：`ah-think` 技能中的思维模型详细说明

---

## 阶段三：回顾今日想法

> 🔑 **这是新增的核心环节**：每天结束时，回顾当天记录的想法，决定去向。

### 3.1 提取今日想法

从今日日记的 `### 💡 想法和灵感` 区域提取内容。

**提取规则**：
- 识别以 `- ` 开头的条目
- 提取时间戳（如有）
- 提取标签（如有）
- **过滤已有处理标记的条目**（如 `✅ 已处理`、`→ [[笔记]]`、`→ 任务`）

### 3.2 展示今日想法

```
反思环节完成了！现在让我们看看你今天记录的想法。

📝 **今日想法回顾**

今天你记录了 **{{N}}** 条想法：

| # | 时间 | 内容预览 |
|---|------|----------|
| 1 | 09:15 | 习惯的本质是大脑的自动化程序... |
| 2 | 14:22 | 用户体验的核心是减少认知负担 |
| 3 | 16:00 | 记得下周预约体检 |

我们来快速过一遍，决定每条的去向。
```

### 3.3 逐条处理

```
📝 **第 {{i}}/{{N}} 条**

**时间**：{{HH:mm}}

---
{{完整内容}}
---

这条想法应该：
1. 💡 转为永久笔记（有价值的洞察）
2. ✅ 转为任务（需要行动）
3. ☑️ 标记已处理（不需进一步处理）
4. ⏭️ 跳过（明天/周末再处理）

你的选择是？
```

### 3.4 根据选择处理

#### 选择1：转为永久笔记

> 🔗 **调用 `ah-card` 技能**：转永久笔记必须使用永久笔记制作技能，确保质量和链接。
>
> ⚠️ **完成后必须返回 ah-review 继续处理下一条想法！**

```
好的，让我们把它转化为永久笔记。

[执行 ah-card 流程，但不离开 ah-review 上下文]

1. 确定断言式标题（完整陈述句）
2. 用自己的话表达核心观点
3. 扫描知识库推荐链接
4. 归类到相关主题页

[ah-card 完成后]

✅ 永久笔记已创建：[[笔记标题]]

继续处理下一条想法...
```

完成后，在日记中标记：
```markdown
- 09:15 习惯的本质是大脑的自动化程序... → [[改变习惯的关键是替换行为]]
```

> ⚠️ **关键**：这里不是「切换」到 ah-card，而是在 ah-review 流程内「调用」ah-card 的能力。调用完成后继续 ah-review 的下一步。

#### 选择2：转为任务

```
这是一个需要行动的事项。

我会把它添加到今日（或明日）日记的任务列表中：
- [ ] {{任务内容}}

确认添加吗？
```

添加后，在日记中标记：
```markdown
- 16:00 记得下周预约体检 → 任务
```

#### 选择3：标记已处理

```
好的，这条想法标记为已处理。
```

在日记中标记：
```markdown
- 14:22 用户体验的核心是减少认知负担 ✅ 已处理
```

#### 选择4：跳过

```
好的，跳过这条。你可以在周回顾时再处理。
```

不做任何标记，保持原样。

### 3.5 快速模式

如果想法较多（>5条），提供快速模式：

```
想法较多（{{N}}条），要使用快速模式吗？

快速模式下：
- 我只展示内容，你直接说数字
- 1=永久笔记，2=任务，3=已处理，4=跳过
- 批量处理更高效
```

---

## 阶段四：更新日记

### 4.1 更新内容

根据对话内容，更新日记的以下部分：

**简单反思**：
```markdown
## 🤔 简单反思

**做得好的**：{{用户实际说的内容}}

**明天改进**：{{用户实际说的内容}}
```

**想法处理标记**：
在「💡 想法和灵感」区域更新处理标记。

**待处理**（如有跳过的想法）：
```markdown
## 🔄 待处理

- [ ] 有 {{M}} 条想法待周末整理
```

> ⚠️ 注意：以上内容必须来自本次对话，不要使用任何示例中的内容

### 4.2 创建明日日记（可选）

如果用户确认了明日计划，可以提前创建明日日记：

```
要我帮你创建明天的日记，把「{{明日最重要的事}}」填进去吗？
```

---

## 阶段五：结束与建议

### 5.1 总结

```
今天的回顾完成了！✨

**今日亮点**：
- {{做得好的事}}

**明日聚焦**：
- {{最重要的一件事}}

**想法处理**：
- 💡 转永久笔记：{{n}}条
- ✅ 转任务：{{n}}条
- ☑️ 标记已处理：{{n}}条
- ⏭️ 跳过（待周末处理）：{{n}}条

今天辛苦了，好好休息！🌙
```

### 5.2 后续建议

如果有跳过的想法：

```
💡 提示：有 {{M}} 条想法暂时跳过了，记得周末用 `/ah-week` 做周回顾时一起处理。
```

---

## 示例对话

> ⚠️ **以下仅为对话格式示例**，其中的项目名称、书籍、任务等都是虚构的。
> 实际执行时，必须先读取用户的真实日记，基于日记中的实际内容进行对话。

```
用户：/ah-review

AI：晚上好！让我们来回顾一下今天。

[读取今日日记] ← 必须执行这一步！

我看到你今天的日记中提到了：
- 今日聚焦：完成产品需求文档
- 任务：3完成/5总共
- 想法：记录了4条

今天的回顾，你想怎么进行？

---

用户：A，深度回顾

AI：好的！你今天的聚焦是「完成产品需求文档」，完成得怎么样？

---

用户：完成了大部分，还有一些细节明天再补充

AI：很好！能完成大部分已经不错了。是什么帮助你今天能专注在这件事上？

---

用户：上午状态比较好，我把手机放在另一个房间了

AI：「把手机放在另一个房间」——这是一个很实用的策略！

让我继续问：明天最重要的一件事是什么？

---

用户：把需求文档完成

AI：明白了！

反思环节完成。现在让我们看看你今天记录的 **4 条** 想法：

| # | 时间 | 内容 |
|---|------|------|
| 1 | 09:15 | 习惯的本质是大脑的自动化程序 |
| 2 | 14:22 | 用户体验的核心是减少认知负担 |
| 3 | 16:00 | 记得下周预约体检 |
| 4 | 17:30 | 产品设计要考虑用户的心智模型 |

📝 **第 1/4 条**：习惯的本质是大脑的自动化程序

1=永久笔记，2=任务，3=已处理，4=跳过

---

用户：1

AI：永久笔记标题建议：**改变习惯的关键是替换行为**

确认创建吗？

---

用户：确认

AI：✅ 已创建！继续下一条。

📝 **第 2/4 条**：用户体验的核心是减少认知负担

---

用户：1

AI：永久笔记标题建议：**用户体验的核心是减少认知负担**

确认吗？

---

用户：确认

AI：✅ 已创建！继续。

📝 **第 3/4 条**：记得下周预约体检

---

用户：2

AI：好的，添加到任务：
- [ ] 下周预约体检

确认吗？

---

用户：确认

AI：✅ 已添加！最后一条。

📝 **第 4/4 条**：产品设计要考虑用户的心智模型

---

用户：3

AI：✅ 标记为已处理。

---

今天的回顾完成了！✨

**今日亮点**：
- 把手机放在另一个房间，提高了专注力

**明日聚焦**：
- 完成需求文档

**想法处理**：
- 💡 转永久笔记：2条
- ✅ 转任务：1条
- ☑️ 标记已处理：1条

新创建的永久笔记：
- [[改变习惯的关键是替换行为]]
- [[用户体验的核心是减少认知负担]]

今天辛苦了，好好休息！🌙
```

---

## 想法处理状态标记规范

在每日笔记的「💡 想法和灵感」区域，每条想法的状态通过后缀标记：

| 状态 | 标记格式 | 示例 |
|------|----------|------|
| 未处理 | （无标记） | `- 09:15 内容...` |
| 转永久笔记 | `→ [[笔记名]]` | `- 09:15 内容... → [[笔记名]]` |
| 转任务 | `→ 任务` | `- 09:15 内容... → 任务` |
| 已处理 | `✅ 已处理` | `- 09:15 内容... ✅ 已处理` |

**判断未处理的规则**：条目中不包含 `→` 和 `✅` 的即为未处理。

---

## 注意事项

1. **不要机械化**：根据用户的回答灵活调整问题，不要按脚本走
2. **尊重用户状态**：如果用户很累，可以简化流程
3. **避免说教**：是引导反思，不是评判用户的一天
4. **保留原话**：记录时尽量保留用户的原始表达
5. **适时结束**：不要拖得太长，5-10分钟为宜
6. **想法处理可选**：如果用户想跳过想法处理环节，尊重选择

---

## 相关技能

- **ah-capture**：白天记录想法到每日笔记
- **ah-card**：将洞察转化为永久笔记
- **ah-week**：每周做更全面的复盘，处理残留的未处理想法
- **ah-inbox**：专门批量处理多天积累的想法
